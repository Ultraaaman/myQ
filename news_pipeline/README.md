# æ–°é—»æ•°æ®å¤„ç†æµæ°´çº¿

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ–°é—»æ•°æ®é‡‡é›†å’Œåˆ†ææµæ°´çº¿ï¼ŒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒè„šæœ¬ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
news_pipeline/
â”œâ”€â”€ README.md                      # æœ¬æ–‡æ¡£
â”œâ”€â”€ period_news_fetcher.py         # æ­¥éª¤1ï¼šæ–°é—»æŠ“å–è„šæœ¬
â””â”€â”€ batch_sentiment_analyzer.py    # æ­¥éª¤2ï¼šæƒ…æ„Ÿåˆ†æè„šæœ¬
```

## ğŸ”„ å·¥ä½œæµç¨‹

```
æ­¥éª¤1: æŠ“å–æ–°é—»               æ­¥éª¤2: æƒ…æ„Ÿåˆ†æ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ period_news_    â”‚           â”‚ batch_sentiment_â”‚
â”‚ fetcher.py      â”‚  â”€â”€â”€â”€â”€â”€â”€> â”‚ analyzer.py     â”‚
â”‚                 â”‚  CSVæ–‡ä»¶   â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“                             â†“
   åŸå§‹æ–°é—»CSV                   åˆ†æç»“æœCSV
```

## ğŸ“‹ ä½¿ç”¨æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæŠ“å–æ–°é—»æ•°æ®

```bash
# è¿›å…¥ç›®å½•
cd D:/projects/q/myQ/news_pipeline

# æŠ“å–æŒ‡å®šæ—¶é—´æ®µçš„æ–°é—»
python period_news_fetcher.py --start_date 2025-09-01 --end_date 2025-09-30
```

**è¾“å‡ºæ–‡ä»¶**ï¼š
- ä½ç½®ï¼š`D:/projects/q/myQ/output/period_news/`
- æ–‡ä»¶åï¼š`news_20250901_20250930.csv`

### ç¬¬äºŒæ­¥ï¼šæƒ…æ„Ÿåˆ†æ

```bash
# å¯¹æŠ“å–çš„æ–°é—»è¿›è¡Œæƒ…æ„Ÿåˆ†æ
python batch_sentiment_analyzer.py --input news_20250901_20250930.csv
```

**è¾“å‡ºæ–‡ä»¶**ï¼š
- ä½ç½®ï¼š`D:/projects/q/myQ/output/analyzed_news/`
- æ–‡ä»¶åï¼š`news_20250901_20250930_analyzed.csv`

## ğŸ“Š è„šæœ¬è¯¦ç»†è¯´æ˜

### 1. period_news_fetcher.py - æ–°é—»æŠ“å–è„šæœ¬

**åŠŸèƒ½**ï¼š
- ä»TushareæŠ“å–æŒ‡å®šæ—¶é—´æ®µçš„æ–°é—»
- è‡ªåŠ¨åŒ¹é…è‚¡ç¥¨æ± ä¸­çš„è‚¡ç¥¨
- è‡ªåŠ¨è¿‡æ»¤å‘¨æœ«ï¼Œåªå¤„ç†äº¤æ˜“æ—¥
- å¢é‡å†™å…¥ï¼Œæ•°æ®å®‰å…¨

**å‚æ•°**ï¼š
```bash
--start_date    å¼€å§‹æ—¥æœŸ (YYYY-MM-DD)  [å¿…éœ€]
--end_date      ç»“æŸæ—¥æœŸ (YYYY-MM-DD)  [å¿…éœ€]
```

**ç¤ºä¾‹**ï¼š
```bash
# æŠ“å–2025å¹´9æœˆçš„æ–°é—»
python period_news_fetcher.py --start_date 2025-09-01 --end_date 2025-09-30

# æŠ“å–å•æ—¥æ–°é—»
python period_news_fetcher.py --start_date 2025-09-28 --end_date 2025-09-28
```

**è¾“å‡ºCSVå­—æ®µ**ï¼š
- `datetime`: æ–°é—»å‘å¸ƒæ—¶é—´
- `title`: æ–°é—»æ ‡é¢˜
- `content`: æ–°é—»å†…å®¹
- `stock_code`: è‚¡ç¥¨ä»£ç 
- `stock_name`: è‚¡ç¥¨åç§°
- `industry`: æ‰€å±è¡Œä¸š
- `matched_keyword`: åŒ¹é…çš„å…³é”®è¯
- `fetch_date`: æŠ“å–æ—¥æœŸ

### 2. batch_sentiment_analyzer.py - æƒ…æ„Ÿåˆ†æè„šæœ¬

**åŠŸèƒ½**ï¼š
- è¯»å–æŠ“å–çš„æ–°é—»CSVæ–‡ä»¶
- ä½¿ç”¨å¤§æ¨¡å‹è¿›è¡Œæ‰¹é‡æƒ…æ„Ÿåˆ†æ
- æ™ºèƒ½é‡å¤æ£€æµ‹ï¼Œé¿å…é‡å¤åˆ†æ
- å¢é‡å†™å…¥ï¼Œä¿è¯æ•°æ®å®‰å…¨

**å‚æ•°**ï¼š
```bash
--input         è¾“å…¥çš„æ–°é—»CSVæ–‡ä»¶å  [å¿…éœ€]
--batch_size    æ‰¹æ¬¡å¤§å°ï¼Œé»˜è®¤4æ¡
```

**ç¤ºä¾‹**ï¼š
```bash
# åŸºæœ¬ç”¨æ³•
python batch_sentiment_analyzer.py --input news_20250901_20250930.csv

# æŒ‡å®šæ‰¹æ¬¡å¤§å°ï¼ˆæ¯æ¬¡åˆ†æ6æ¡æ–°é—»ï¼‰
python batch_sentiment_analyzer.py --input news_20250901_20250930.csv --batch_size 6
```

**åˆ†æç»´åº¦**ï¼š
- `sentiment`: æƒ…æ„Ÿæ ‡ç­¾ï¼ˆå¼ºçƒˆæ­£é¢/æ­£é¢/ä¸­æ€§åæ­£/ä¸­æ€§/ä¸­æ€§åè´Ÿ/è´Ÿé¢/å¼ºçƒˆè´Ÿé¢ï¼‰
- `direct_impact_score`: ç›´æ¥å½±å“è¯„åˆ†ï¼ˆ-5åˆ°+5ï¼‰
- `direct_impact_desc`: ç›´æ¥å½±å“æè¿°
- `indirect_impact_score`: é—´æ¥å½±å“è¯„åˆ†ï¼ˆ-5åˆ°+5ï¼‰
- `indirect_impact_desc`: é—´æ¥å½±å“æè¿°
- `certainty`: ç¡®å®šæ€§ï¼ˆ0-1ï¼‰
- `time_to_effect`: å½±å“æ—¶é—´çª—å£
- `overall_score`: ç»¼åˆè¯„åˆ†ï¼ˆ-10åˆ°+10ï¼‰
- `risk_factors`: ä¸»è¦é£é™©å› ç´ 
- `action_suggestion`: å»ºè®®æ“ä½œ
- `analysis_time`: åˆ†ææ—¶é—´

## ğŸ”§ é…ç½®è¦æ±‚

### APIå¯†é’¥é…ç½®

éœ€è¦åœ¨ `D:/projects/q/myQ/config/api_config.py` ä¸­é…ç½®ï¼š

```python
# Tushare API Token (ç”¨äºæ–°é—»æŠ“å–)
TUSHARE_TOKEN = "your_tushare_token_here"

# OpenRouter API Key (ç”¨äºæƒ…æ„Ÿåˆ†æ)
OPENROUTER_API_KEY = "your_openrouter_api_key_here"
```

### è‚¡ç¥¨æ± é…ç½®

ç¡®ä¿ `D:/projects/q/myQ/config/stock_pool.json` æ–‡ä»¶å­˜åœ¨ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```json
{
  "stocks": [
    {
      "stock_code": "600000.SH",
      "stock_name": "æµ¦å‘é“¶è¡Œ",
      "industry": "é“¶è¡Œ"
    }
  ]
}
```

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. å¢é‡æ›´æ–°

å¦‚æœéœ€è¦æ›´æ–°æŸä¸ªæ—¶é—´æ®µçš„æ•°æ®ï¼š

```bash
# ç¬¬ä¸€æ¬¡æŠ“å–
python period_news_fetcher.py --start_date 2025-09-01 --end_date 2025-09-30

# å¦‚æœå‘ç°æœ‰æ–°æ–°é—»ï¼Œå†æ¬¡è¿è¡Œï¼ˆæ–‡ä»¶ä¼šè¢«è¦†ç›–ï¼‰
# å»ºè®®ï¼šå…ˆå¤‡ä»½åŸæ–‡ä»¶æˆ–ä½¿ç”¨ä¸åŒçš„æ—¥æœŸèŒƒå›´
```

### 2. åˆ†æ‰¹åˆ†æï¼ˆèŠ‚çœè´¹ç”¨ï¼‰

æƒ…æ„Ÿåˆ†æè„šæœ¬æ”¯æŒå¤šæ¬¡è¿è¡Œï¼Œä¼šè‡ªåŠ¨è·³è¿‡å·²åˆ†æçš„æ–°é—»ï¼š

```bash
# ç¬¬ä¸€æ¬¡åˆ†æï¼ˆåˆ†ææ‰€æœ‰æ–°é—»ï¼‰
python batch_sentiment_analyzer.py --input news_20250901_20250930.csv

# å¦‚æœä¸­é€”ä¸­æ–­ï¼Œå†æ¬¡è¿è¡Œä¼šä»ä¸Šæ¬¡åœæ­¢çš„åœ°æ–¹ç»§ç»­
python batch_sentiment_analyzer.py --input news_20250901_20250930.csv

# ğŸ’° å·²åˆ†æè¿‡çš„æ–°é—»ä¼šè¢«è‡ªåŠ¨è·³è¿‡ï¼ŒèŠ‚çœAPIè´¹ç”¨
```

### 3. æ•°æ®å®‰å…¨

ä¸¤ä¸ªè„šæœ¬éƒ½é‡‡ç”¨**å¢é‡å†™å…¥**ç­–ç•¥ï¼š
- æ¯å¤„ç†ä¸€å¤©/ä¸€æ‰¹æ•°æ®ï¼Œç«‹å³å†™å…¥ç£ç›˜
- å³ä½¿è„šæœ¬ä¸­é€”ä¸­æ–­ï¼Œå·²å¤„ç†çš„æ•°æ®ä¸ä¼šä¸¢å¤±
- å¯ä»¥éšæ—¶æŸ¥çœ‹éƒ¨åˆ†ç»“æœ

### 4. æ‰¹æ¬¡å¤§å°è°ƒä¼˜

æƒ…æ„Ÿåˆ†æçš„ `--batch_size` å‚æ•°å½±å“ï¼š
- **è¾ƒå°å€¼(2-4)**ï¼šæ›´ç¨³å®šï¼Œä½†è€—æ—¶æ›´é•¿
- **è¾ƒå¤§å€¼(6-8)**ï¼šæ›´å¿«ï¼Œä½†å¯èƒ½é‡åˆ°APIé™åˆ¶
- **å»ºè®®å€¼**ï¼š4ï¼ˆé»˜è®¤å€¼ï¼Œå¹³è¡¡é€Ÿåº¦å’Œç¨³å®šæ€§ï¼‰

## ğŸ“ˆ å…¸å‹ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæœˆåº¦æ–°é—»åˆ†æ

```bash
# 1. æŠ“å–æ•´æœˆæ–°é—»
python period_news_fetcher.py --start_date 2025-09-01 --end_date 2025-09-30

# 2. è¿›è¡Œæƒ…æ„Ÿåˆ†æ
python batch_sentiment_analyzer.py --input news_20250901_20250930.csv

# 3. ç»“æœå¯ç”¨äºåç»­ç­–ç•¥ç ”ç©¶
```

### åœºæ™¯2ï¼šå†å²æ•°æ®å›æº¯

```bash
# æ‰¹é‡æŠ“å–å†å²æ•°æ®ï¼ˆæŒ‰æœˆæŠ“å–ï¼‰
python period_news_fetcher.py --start_date 2025-01-01 --end_date 2025-01-31
python period_news_fetcher.py --start_date 2025-02-01 --end_date 2025-02-28
# ... ä¾æ­¤ç±»æ¨

# ç„¶ååˆ†åˆ«åˆ†æ
python batch_sentiment_analyzer.py --input news_20250101_20250131.csv
python batch_sentiment_analyzer.py --input news_20250201_20250228.csv
```

### åœºæ™¯3ï¼šå•æ—¥å¿«é€Ÿåˆ†æ

```bash
# åˆ†æä»Šå¤©çš„æ–°é—»
TODAY=$(date +%Y-%m-%d)
python period_news_fetcher.py --start_date $TODAY --end_date $TODAY
python batch_sentiment_analyzer.py --input news_${TODAY//-/}_${TODAY//-/}.csv
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **APIé™åˆ¶**ï¼š
   - Tushareå¯èƒ½æœ‰è°ƒç”¨é¢‘ç‡é™åˆ¶
   - OpenRouterå…è´¹é¢åº¦æœ‰é™ï¼Œæ³¨æ„æˆæœ¬æ§åˆ¶
   - è„šæœ¬å·²å†…ç½®å»¶è¿Ÿå’Œé‡è¯•æœºåˆ¶

2. **æ•°æ®æ—¶æ•ˆæ€§**ï¼š
   - æ–°é—»æ•°æ®å¯èƒ½æœ‰å»¶è¿Ÿ
   - å‘¨æœ«å’ŒèŠ‚å‡æ—¥é€šå¸¸æ— äº¤æ˜“æ—¥æ–°é—»

3. **æ–‡ä»¶è¦†ç›–**ï¼š
   - æŠ“å–è„šæœ¬ä¼šè¦†ç›–åŒåæ–‡ä»¶
   - åˆ†æè„šæœ¬é‡‡ç”¨è¿½åŠ æ¨¡å¼ï¼Œä¸ä¼šè¦†ç›–

4. **ä¸­æ–­æ¢å¤**ï¼š
   - ä¸¤ä¸ªè„šæœ¬éƒ½æ”¯æŒä¸­æ–­åç»§ç»­
   - é‡æ–°è¿è¡Œå³å¯ä»æ–­ç‚¹ç»§ç»­

## ğŸ“ æ›´æ–°æ—¥å¿—

- **2025-01-XX**: åˆå§‹ç‰ˆæœ¬
  - åˆ›å»ºæ–°é—»æŠ“å–è„šæœ¬
  - åˆ›å»ºæƒ…æ„Ÿåˆ†æè„šæœ¬
  - é‡‡ç”¨å¢é‡å†™å…¥ç­–ç•¥
  - æ”¯æŒé‡å¤æ£€æµ‹

## ğŸ¤ ç»´æŠ¤è¯´æ˜

è¿™ä¸¤ä¸ªè„šæœ¬è®¾è®¡ä¸ºé•¿æœŸä½¿ç”¨ï¼Œå»ºè®®ï¼š
1. å®šæœŸå¤‡ä»½è¾“å‡ºæ•°æ®
2. ç›‘æ§APIä½¿ç”¨é‡å’Œè´¹ç”¨
3. æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æ‰¹æ¬¡å¤§å°
4. å®šæœŸæ›´æ–°è‚¡ç¥¨æ± é…ç½®

---

**ç›®å½•è·¯å¾„**: `D:/projects/q/myQ/news_pipeline/`
**è¾“å‡ºè·¯å¾„**: `D:/projects/q/myQ/output/`
